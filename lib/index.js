// Generated by CoffeeScript 2.5.1
(function() {
  var HTTP_ACCEPTED, HTTP_NO_CONTENT, PORT, app, controllers, express, routes;

  express = require('express');

  PORT = 3000;

  HTTP_ACCEPTED = 202;

  HTTP_NO_CONTENT = 204;

  app = express();

  // using app.locals as our 'data store'; reachable at req.app.locals
  app.locals.users = [];

  // this could be extracted to a controllers/user.coffee file
  controllers = {
    heartbeat: function(_, res) {
      return res.send('Hello World!');
    },
    getAll: function(req, res) {
      var users;
      ({users} = req.app.locals);
      return res.send(users);
    },
    getById: function(req, res) {
      var id, users;
      ({id} = req.params);
      ({users} = req.app.locals);
      return res.send(users[id]);
    },
    add: function(req, res) {
      var u, users;
      ({users} = req.app.locals);
      u = {
        id: users.length
      };
      users.push(u);
      return res.send(u);
    },
    delete: function(req, res) {
      var id, s, users;
      ({id} = req.params);
      ({users} = req.app.locals);
      s = HTTP_NO_CONTENT;
      if (users[id] != null) {
        s = HTTP_ACCEPTED;
        users.splice(id);
      }
      return res.status(s).send();
    }
  };

  // this could be extracted to a routes/user.coffee file
  routes = express.Router();

  routes.get('/', controllers.heartbeat);

  routes.get('/users', controllers.getAll);

  routes.post('/user', controllers.add);

  routes.get('/user/:id', controllers.getById);

  routes.delete('/user/:id', controllers.delete);

  app.use(routes);

  app.listen(PORT, function() {
    return console.log(`Example app listening at http://localhost:${PORT}`);
  });

}).call(this);
